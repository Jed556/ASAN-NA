<html>

<head>
    <script src="http://code.jquery.com/jquery.min.js"></script>
</head>

<body>
    <div id="accuracy-chart"></div>
    <div id="speed-chart"></div>

    <script type="module">
        import "https://cdn.plot.ly/plotly-2.9.0.min.js"
        // import data from "http://localhost:8888"

        let dataArr = []
        $.ajax({
            url: "http://localhost:8888",
            success: function (data) {
                for (let i = 0; i < data.length; i++) {
                    let trainArr = []
                    data.forEach(val => {
                        if (val.id == i && val.train) {
                            console.log(val.train);
                            trainArr.push(...val.train)
                        }
                    })

                    trainArr.forEach(val => {
                        dataArr.push(val.error)
                    })
                }
                console.log(dataArr);
                return dataArr[cnt]
            }
        })

        Plotly.newPlot('accuracy-chart', [{
            y: [0],
            type: 'line'
        }]);

        var cnt = 0;
        setInterval(function () {
            if (cnt > dataArr.length - 1) {
                cnt--;
            }
            Plotly.extendTraces('accuracy-chart', { y: [[dataArr[cnt]]] }, [0]);
            cnt++;

            if (cnt > 500) {
                Plotly.relayout('accuracy-chart', {
                    xaxis: {
                        range: [cnt - 500, cnt]
                    }
                });
            }

        }, 10);

    </script>

</body>


</html>